(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["powder-shop"],{"2fa3":function(t,e,s){"use strict";function i(t,e){var s=null;return function(){clearTimeout(s);var i=arguments,n=this;s=setTimeout((function(){t.apply(n,i)}),e)}}function n(t,e){var s=!1;return function(){s||(t.apply(this,arguments),s=!0,setTimeout((function(){s=!1}),e))}}s.d(e,"a",(function(){return i})),s.d(e,"b",(function(){return n}))},3878:function(t,e,s){"use strict";s.r(e);var i=s("7d68"),n=s("2fa3"),o={};function r(t){o.start||(o.start=t.touches[0]||t.changedTouches[0])}function a(t){t.preventDefault()}function c(t){var e=t.touches[0]||t.changedTouches[0];if(o.start){if(o.start.clientX-e.clientX>50){const e=new CustomEvent("swipe-left",{bubbles:!0,cancelable:!1});t.target.dispatchEvent(e)}else if(o.start.clientX-e.clientX<-50){const e=new CustomEvent("swipe-right",{bubbles:!0,cancelable:!1});t.target.dispatchEvent(e)}else if(o.start.clientY-e.clientY>50){const e=new CustomEvent("swipe-down",{bubbles:!0,cancelable:!1});t.target.dispatchEvent(e)}else if(o.start.clientY-e.clientY<-50){const e=new CustomEvent("swipe-up",{bubbles:!0,cancelable:!1});t.target.dispatchEvent(e)}delete o.start}}var l,h,d={name:"powder-shop",components:{ctrlf:i["a"]},data:function(){return{shop:[],artifacts:null,slide:0,focused:null,observer:null,animationEnter:"slide-from-right",openShopList:!1}},computed:{mobile:function(){return this.$store.state.isMobile},saveDataMode:function(){return this.mobile}},watch:{slide:function(t,e){this.focused=null,this.animationEnter=e>t?"slide-from-right":"slide-from-left"}},beforeCreate:function(){this.$store.commit("loading",!0)},created:function(){this.toggleLoading(!0),Promise.all([this.$store.dispatch("getPowderShop"),this.$store.dispatch("getArtifactDB")]).then(t=>{this.shop=t[0],this.artifacts=t[1],this.ready=!0,this.$nextTick(()=>{this.toggleLoading(!1),this.createObserver();var t=document.getElementById("shop-slides");t.addEventListener("wheel",this.mousewheel,{passive:!0}),document.addEventListener("keydown",this.handleKeyDown,!1),t.addEventListener("touchstart",r,{passive:!0}),t.addEventListener("touchmove",a,{passive:!1}),t.addEventListener("touchend",c,{passive:!0})})}).catch(t=>console.log(t))},beforeDestroy:function(){var t=document.getElementById("shop-slides");document.removeEventListener("keydown",this.handleKeyDown),t.removeEventListener("wheel",this.mousewheel),t.removeEventListener("touchstart",r),t.removeEventListener("touchmove",a),t.removeEventListener("touchend",c);const e=document.querySelectorAll("li");e.forEach(t=>{this.observer.unobserve(t)}),this.destroyObserver(),this.observer=null},mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{home:function(){this.$store.commit("toggleMainMenu")},toggleLoading:function(t,e){this.$store.commit("loading",t,e)},loading:function(){return this.$store.commit("loading",!0),new Promise(t=>{setTimeout(()=>{t(),this.$nextTick(()=>{this.$store.commit("loading",!1)})},0)})},artifact:function(t){return this.$store.getters.getArtifact(t)},getArtifactName:function(t){return this.$store.getters.getArtifactName(t)},getArtifactIcon:function(t){return this.$store.getters.getArtifactIcon(t)},getArtifactImage:function(t){return this.$store.getters.getArtifactImage(t)},getRarityIcon:function(t){return this.$store.getters.getRarityIcon(t)},getRoleIcon:function(t){return this.$store.getters.getRoleIcon(t)},toggleShopList:function(){this.openShopList=!this.openShopList},focusArtifact:function(t){this.focused!==t?this.focused=t:this.focused=null},searchFunction:function(t){const e=this.shop;if(!e.length||!t)return[];const s=t.toLowerCase();return e.filter(t=>!(!t.a||!Array.isArray(t.a))&&t.a.some(t=>-1!==this.$store.getters.getArtifactName(t.id).toLowerCase().indexOf(s)))},searchToDisplay:function(t){return t.dt.join(" ~ ")},goToResult:function(t){this.shop.forEach((e,s)=>{e===t&&(this.slide=s)})},mousewheel:Object(n["b"])((function(t){t.deltaY<0?this.slide>0&&(document.getElementById("shop-slides").scrollTop=(this.slide-1)*window.innerHeight):this.slide<this.shop.length&&(document.getElementById("shop-slides").scrollTop=(this.slide+1)*window.innerHeight)}),300),scrollSlide:function(){var t=document.body.scrollTop;window.requestAnimationFrame(()=>{var e=document.body.scrollTop;t>=e?this.slide>0&&(window.scrollY=(this.slide-1)*window.innerHeight-10):this.slide<this.shop.length&&(window.scrollY=(this.slide+1)*window.innerHeight-10)})},scrollBySwipe:function(t){t>0&&this.slide<this.shop.length?document.getElementById("shop-slides").scrollTop=(this.slide+1)*window.innerHeight:t<0&&this.slide>0&&(document.getElementById("shop-slides").scrollTop=(this.slide-1)*window.innerHeight)},handleKeyDown:Object(n["b"])((function(t){t.ctrlKey||"INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&"true"!=t.target.contentEditable&&(t.preventDefault(),39===t.keyCode||"ArrowRight"===t.key||40===t.keyCode||"ArrowDown"===t.key||68===t.keyCode||"d"===t.key?this.scrollBySwipe(1):37!==t.keyCode&&"ArrowLeft"!==t.key&&38!==t.keyCode&&"ArrowUp"!==t.key&&65!==t.keyCode&&"a"!==t.key||this.scrollBySwipe(-1))}),300),scrollToSelected:function(t){document.getElementById("shop-slides").scrollTop=t*window.innerHeight},createObserver:function(){let t={root:null,rootMargin:"0px",threshold:.8};this.observer=new IntersectionObserver(t=>{t.forEach(t=>{var e=parseInt(t.target.attributes.index.value);t.isIntersecting&&(this.slide=e)})},t);const e=document.querySelectorAll("li");e.forEach(t=>{this.observer.observe(t)})},destroyObserver:function(){this.observer&&this.observer.disconnect()}},render:function(t){return t("section",{staticClass:"",attrs:{id:"shop-container"},style:{}},[t("floating-menu",{props:{mobile:this.mobile,options:[{title:"Search",class:"fa fa-search",click:"search"},{title:"Home",class:"fa fa-home",click:"home"}]},on:{home:()=>this.home(),search:()=>this.$refs.ctrlf.openSearchBar()}}),t("ctrlf",{ref:"ctrlf",props:{events:this.shop,searchFunction:this.searchFunction,toDisplay:this.searchToDisplay},on:{event:this.goToResult}}),t("ul",{style:{width:"100%",height:"100%",overflow:"auto"},attrs:{id:"shop-slides"},on:{"swipe-left":()=>this.scrollBySwipe(1),"swipe-right":()=>this.scrollBySwipe(-1),"swipe-up":()=>this.scrollBySwipe(-1),"swipe-down":()=>this.scrollBySwipe(1)}},[this.shop[this.slide]?t("transition",{attrs:{name:this.animationEnter}},[t("div",{key:this.slide,staticClass:"powder-slide-rotations",style:{position:"absolute","z-index":1,top:0,left:0}},[t("div",{staticClass:"title-container"},[t("button",{staticClass:"fa rotation-list-btn",class:{"fa-list":!this.openShopList,"fa-times":this.openShopList},on:{click:()=>this.toggleShopList()}}),this.shop[this.slide].nid?t("a",{attrs:{target:"_blank",href:"https://page.onstove.com/epicseven/global/view/"+this.shop[this.slide].nid,crossorigin:"anonymous",SameSite:"Lax"},style:{float:"right",height:"100%",width:"110px","margin-right":"14px",background:"url(https://static-cdn.onstove.com/0.0.14/img/gnb/bi.svg) no-repeat scroll 0% 50%"},directives:[{name:"tooltip",value:"Read patch notice on stove."}]},[]):null,t("span",{style:{float:"left","padding-left":"10px"}},this.slide+1+"/"+this.shop.length),t("div",{style:{margin:"0 180px 0 55px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},this.shop[this.slide].dt.join(" ~ "))]),t("div",{staticClass:"rotation"},[this.saveDataMode?t("div",{style:{"align-self":"center",width:"100%","max-width":"450px"}},[this.shop[this.slide].a.map(e=>{var s=(window.innerHeight-100)/this.shop[this.slide].a.length+"px";return t("div",{style:{display:"flex",width:"100%","align-items":"center"}},[t("img",{attrs:{src:this.getArtifactIcon(e.id),crossorigin:"anonymous",SameSite:"Lax"},style:{height:s},directives:[{name:"tooltip",value:'<img height="200" src="'+this.getArtifactImage(e.id)+'">'}]}),t("img",{attrs:{src:this.getRoleIcon(this.artifact(e.id).role)},style:{height:"30px"}}),t("span",{style:{flex:1,margin:"0 20px"}},this.getArtifactName(e.id)),t("span",{style:{overflow:"hidden","white-space":"nowrap","padding-left":"8px"}},new Array(this.artifact(e.id).rarity||1).fill(t("img",{attrs:{src:this.getRarityIcon()},style:{height:"20px","margin-left":"-8px","vertical-align":"middle"}})))])})]):this.shop[this.slide].a.map((e,s)=>t("div",{staticClass:"artifact",class:{focused:this.focused===s},on:{click:()=>this.focusArtifact(s)},style:{}},[t("img",{staticClass:"artwork",style:{opacity:0},attrs:{crossorigin:"anonymous",SameSite:"Lax",src:this.getArtifactImage(e.id)},on:{load:t=>t.target.style.opacity=1}}),t("span",{style:{"padding-left":"8px"}},new Array(this.artifact(e.id).rarity||1).fill(t("img",{attrs:{src:this.getRarityIcon(),SameSite:"Lax",crossorigin:"anonymous"},style:{height:"20px","margin-left":"-8px","vertical-align":"middle"}}))),t("span",{staticClass:"vertical-name"},this.getArtifactName(e.id))])),this.shop[this.slide].content?t("div",{domProps:{innerHTML:this.shop[this.slide].content}}):null])])]):null,this.shop.map((e,s)=>t("li",{staticClass:"powder-slide-rotations",style:{visibility:"hidden"},attrs:{index:s}},[t("div",{staticClass:"title-container"},"Data della rotazione"),t("div",{staticClass:"rotation"})]))]),this.shop&&this.openShopList?t("div",{staticClass:"glass-container rotation-list-box"},[this.shop.map((e,s)=>t("div",{staticClass:"elements",class:{active:this.slide===s},on:{click:()=>this.scrollToSelected(s)}},s+1+". "+e.dt[0]))]):null])}},u=d,p=(s("eb71"),s("2877")),f=Object(p["a"])(u,l,h,!1,null,null,null);e["default"]=f.exports},"6d86":function(t,e,s){},"7d68":function(t,e,s){"use strict";var i,n,o=s("2fa3"),r={name:"ctrlf",props:{events:{type:Array,required:!1,default:()=>[]},renderBox:{type:Boolean,required:!1,default:!0},searchFunction:{type:Function,required:!0},toDisplay:{type:Function,required:!0}},data:function(){return{render:!1,current:0,results:[],hideResultsBox:!1}},computed:{mobile:function(){return!0}},created:function(){document.addEventListener("keydown",this.openCtrl,!0)},beforeDestroy:function(){document.removeEventListener("keydown",this.openCtrl,!0)},mounted:function(){},methods:{openCtrl:function(t){t.ctrlKey&&"f"===t.key&&(t.preventDefault(),this.render=!0,this.openSearchBar())},openSearchBar:function(){this.render=!0,this.focusInput(),this.selectInputContent()},focus:function(){this.focusInput(),this.selectInputContent()},focusInput:function(){this.$nextTick(()=>{this.$refs["input-search-box"].focus()})},selectInputContent:function(){this.$nextTick(()=>{this.$refs["input-search-box"].select()})},searchEvent:Object(o["a"])((function(t){this.results=this.searchFunction(t.target.value),this.current=0,this.clickEvent(this.results[this.current])}),300),goToSearchEvent:function(t){this.results.length&&(this.current=t,this.current<0&&(this.current=this.results.length-1),this.current>this.results.length-1&&(this.current=0),this.clickEvent(this.results[this.current]))},clickEvent:function(t){this.$emit("event",t)},closeSearchBar:function(){this.render=!1}},render:function(t){return t("div",{staticClass:"search-box-pos",style:{display:this.render?"":"none"}},[t("div",{staticClass:"ch-search-box"},[t("input",{ref:"input-search-box",on:{input:t=>this.searchEvent(t),keydown:t=>{("enter"===t.key||13===t.keyCode)&&this.goToSearchEvent(this.current+1)}},attrs:{autocomplete:"off"}}),t("div",{},Math.min(this.current+1,this.results.length)+"/"+this.results.length),t("span",{staticClass:"fas fa-angle-up",on:{click:()=>this.goToSearchEvent(this.current+1)},class:{disabled:0===this.results.length}}),t("span",{staticClass:"fas fa-angle-down",on:{click:()=>this.goToSearchEvent(this.current-1)},class:{disabled:0===this.results.length}}),t("span",{staticClass:"fas fa-bars",on:{click:()=>this.renderBox=!this.renderBox}}),t("span",{staticClass:"fas fa-times",on:{click:()=>this.closeSearchBar()}})]),this.renderBox?t("div",{staticClass:"search-results-box",class:{hidebox:this.hideResultsBox}},this.results.map((e,s)=>t("div",{staticClass:"item",class:{active:s===this.current},on:{click:()=>this.goToSearchEvent(s)}},this.toDisplay(e)))):null])}},a=r,c=(s("9f9f"),s("2877")),l=Object(c["a"])(a,i,n,!1,null,null,null);e["a"]=l.exports},"9f9f":function(t,e,s){"use strict";s("bcfb")},bcfb:function(t,e,s){},eb71:function(t,e,s){"use strict";s("6d86")}}]);